
// 2.2.2 Data Loading with Hive
// Utilize Hive to create tables in the Hadoop Filesystem and then load the Credit Card System data extracted via Sqoop into those tables.
// Data Engineers will need to transform the data based on requirements found in the Mapping Document.



// 1. create external table CDW_SAPP_D_BRANCH, partioned by branch state 

CREATE EXTERNAL TABLE CDW_SAPP_D_BRANCH (
    BRANCH_CODE INT(9);
    BRANCH_NAME VARCHAR(25),
    BRANCH_STREET VARCHAR(30),
    BRANCH_CITY VARCHAR2(30),
    BRANCH_ZIP INT(7),
    BRANCH_PHONE VARCHAR(13),
    LAST_UPDATED TIMESTAMP
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'
PARTITIONED BY (BRANCH_STATE VARCHAR(30))
LOCATION '/user/maria_dev/Credit_Card_System/CDW_SAPP_BRANCH';






// 2. create external table CDW_SAPP_F_CREDIT_CARD, partioned by transaction type 

CREATE EXTERNAL TABLE CDW_SAPP_F_CREDIT_CARD (
    TRANSACTION_ID INT(9),
    CUST_SSN INT(9),
    TIMEID VARCHAR(8),
    CUST_CC_NO STRING(16),
    BRANCH_CODE INT(10),
    TRANSACTION_VALUE DECIMAL(20, 3)
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'
PARTITIONED BY (TRANSACTION_TYPE VARCHAR(30))
LOCATION '/user/maria_dev/Credit_Card_System/CDW_SAPP_CREDIT_CARD';






// 3. create external table CDW_SAPP_D_CUSTOMER, partioned by state 

CREATE EXTERNAL TABLE CDW_SAPP_D_CUSTOMER (
    CUST_SSN INT(9),
    CUST_F_NAME VARCHAR(40),
    CUST_M_NAME VARCHAR(40),
    CUST_L_NAME VARCHAR(40),
    CUST_CC_NO STRING(16),
    CUST)STREET VARCHAR(38),
    CUST_CITY VARCHAR(30),
    CUST_COUNTRY VARCHAR(30),
    CUST_ZIP INT(7),
    CUST_PHONE VARCHAR(8),
    CUST_EMAIL VARCHAR(40),
    LAST_UPDATED TIMESTAMP
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'
PARTITIONED BY (CUST_STATE VARCHAR(30))
LOCATION '/user/maria_dev/Credit_Card_System/CDW_SAPP_CUSTOMER';






// 4. create external table CDW_SAPP_D_TIME, partioned quarterly 

CREATE EXTERNAL TABLE CDW_SAPP_D_TIME (
    TIMEID VARCHAR(8),
    DAY INT(2),
    MONTH INT(2),
    YEAR INT(4)
)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n'
PARTITIONED BY (QUARTER VARCHAR(8))
LOCATION '/user/maria_dev/Credit_Card_System/CDW_SAPP_TIME';















